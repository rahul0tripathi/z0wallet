// Copyright 2024 RISC Zero, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// SPDX-License-Identifier: Apache-2.0

pragma solidity ^0.8.20;

import {RiscZeroCheats} from "risc0/RiscZeroCheats.sol";
import {console2} from "forge-std/console2.sol";
import {Test} from "forge-std/Test.sol";
import {IRiscZeroVerifier} from "risc0/IRiscZeroVerifier.sol";
import {EvenNumber} from "../contracts/EvenNumber.sol";
import {Elf} from "./Elf.sol"; // auto-generated contract after running `cargo build`.

contract EvenNumberTest is RiscZeroCheats, Test {
    EvenNumber public evenNumber;

    function setUp() public {
        IRiscZeroVerifier verifier = deployRiscZeroVerifier();
        evenNumber = new EvenNumber(verifier);
        assertEq(evenNumber.get(), 0);
    }

    function test_SetEven() public {
//        uint256 number = 12345678;
//        (bytes memory journal, bytes32 post_state_digest, bytes memory seal) =
//            prove(Elf.IS_EVEN_PATH, abi.encode(number));
        bytes32 post_state_digest = hex"e31c4b7791c79100f20589336da4a70431cdbbf7071710914c2d8a77d1f1e94e";
        bytes memory seal = hex"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000180000000000000000000000000000000000000000000000000000000000000076000000000000000000000000000000000000000000000000000000000000002500000000000000000000000000000000000000000000000000000000000000f600000000000000000000000000000000000000000000000000000000000000c8000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000fa00000000000000000000000000000000000000000000000000000000000000b300000000000000000000000000000000000000000000000000000000000000fb000000000000000000000000000000000000000000000000000000000000005500000000000000000000000000000000000000000000000000000000000000c600000000000000000000000000000000000000000000000000000000000000bb000000000000000000000000000000000000000000000000000000000000005f00000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000b600000000000000000000000000000000000000000000000000000000000000e7000000000000000000000000000000000000000000000000000000000000009f000000000000000000000000000000000000000000000000000000000000000b000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000a2000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000ec000000000000000000000000000000000000000000000000000000000000008a000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000f400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000b5000000000000000000000000000000000000000000000000000000000000004c00000000000000000000000000000000000000000000000000000000000000e100000000000000000000000000000000000000000000000000000000000000720000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000006b000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000000a5000000000000000000000000000000000000000000000000000000000000004c0000000000000000000000000000000000000000000000000000000000000019000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000d6000000000000000000000000000000000000000000000000000000000000002d00000000000000000000000000000000000000000000000000000000000000c60000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000006600000000000000000000000000000000000000000000000000000000000000fa000000000000000000000000000000000000000000000000000000000000002b00000000000000000000000000000000000000000000000000000000000000ec0000000000000000000000000000000000000000000000000000000000000065000000000000000000000000000000000000000000000000000000000000004100000000000000000000000000000000000000000000000000000000000000d700000000000000000000000000000000000000000000000000000000000000f6000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000000000000000000000000000000000000000000f300000000000000000000000000000000000000000000000000000000000000650000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000006b000000000000000000000000000000000000000000000000000000000000007700000000000000000000000000000000000000000000000000000000000000af00000000000000000000000000000000000000000000000000000000000000d10000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003d00000000000000000000000000000000000000000000000000000000000000a600000000000000000000000000000000000000000000000000000000000000bf000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e20000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000aa00000000000000000000000000000000000000000000000000000000000000690000000000000000000000000000000000000000000000000000000000000048000000000000000000000000000000000000000000000000000000000000007b0000000000000000000000000000000000000000000000000000000000000021000000000000000000000000000000000000000000000000000000000000007900000000000000000000000000000000000000000000000000000000000000bf00000000000000000000000000000000000000000000000000000000000000820000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000003c000000000000000000000000000000000000000000000000000000000000006e000000000000000000000000000000000000000000000000000000000000001f0000000000000000000000000000000000000000000000000000000000000073000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000007200000000000000000000000000000000000000000000000000000000000000ef0000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bd000000000000000000000000000000000000000000000000000000000000001300000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000019000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000eb00000000000000000000000000000000000000000000000000000000000000b5000000000000000000000000000000000000000000000000000000000000000900000000000000000000000000000000000000000000000000000000000000bc00000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000004e000000000000000000000000000000000000000000000000000000000000003400000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000000066000000000000000000000000000000000000000000000000000000000000001200000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000d60000000000000000000000000000000000000000000000000000000000000068000000000000000000000000000000000000000000000000000000000000005c000000000000000000000000000000000000000000000000000000000000007f000000000000000000000000000000000000000000000000000000000000008400000000000000000000000000000000000000000000000000000000000000c7000000000000000000000000000000000000000000000000000000000000007f0000000000000000000000000000000000000000000000000000000000000069000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000de000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001d00000000000000000000000000000000000000000000000000000000000000bc0000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000bb00000000000000000000000000000000000000000000000000000000000000a200000000000000000000000000000000000000000000000000000000000000d000000000000000000000000000000000000000000000000000000000000000a6000000000000000000000000000000000000000000000000000000000000005f00000000000000000000000000000000000000000000000000000000000000e700000000000000000000000000000000000000000000000000000000000000ed000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000a8000000000000000000000000000000000000000000000000000000000000004b0000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000c90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000008c00000000000000000000000000000000000000000000000000000000000000df000000000000000000000000000000000000000000000000000000000000004800000000000000000000000000000000000000000000000000000000000000d8000000000000000000000000000000000000000000000000000000000000007500000000000000000000000000000000000000000000000000000000000000db000000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000008200000000000000000000000000000000000000000000000000000000000000740000000000000000000000000000000000000000000000000000000000000057000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000009900000000000000000000000000000000000000000000000000000000000000ec00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000ea00000000000000000000000000000000000000000000000000000000000000660000000000000000000000000000000000000000000000000000000000000058000000000000000000000000000000000000000000000000000000000000007b0000000000000000000000000000000000000000000000000000000000000048000000000000000000000000000000000000000000000000000000000000000d00000000000000000000000000000000000000000000000000000000000000a5000000000000000000000000000000000000000000000000000000000000002500000000000000000000000000000000000000000000000000000000000000cf00000000000000000000000000000000000000000000000000000000000000bd000000000000000000000000000000000000000000000000000000000000001f0000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000a8000000000000000000000000000000000000000000000000000000000000007600000000000000000000000000000000000000000000000000000000000000b600000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000008b000000000000000000000000000000000000000000000000000000000000004b00000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000b5000000000000000000000000000000000000000000000000000000000000002d000000000000000000000000000000000000000000000000000000000000002500000000000000000000000000000000000000000000000000000000000000910000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000005500000000000000000000000000000000000000000000000000000000000000d0000000000000000000000000000000000000000000000000000000000000005900000000000000000000000000000000000000000000000000000000000000ea00000000000000000000000000000000000000000000000000000000000000fb000000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000002c0000000000000000000000000000000000000000000000000000000000000090000000000000000000000000000000000000000000000000000000000000002d00000000000000000000000000000000000000000000000000000000000000ae000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000bb0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000005400000000000000000000000000000000000000000000000000000000000000a5000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000a2000000000000000000000000000000000000000000000000000000000000002300000000000000000000000000000000000000000000000000000000000000eb000000000000000000000000000000000000000000000000000000000000003f000000000000000000000000000000000000000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000a900000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000068000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000e6000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000de00000000000000000000000000000000000000000000000000000000000000b1000000000000000000000000000000000000000000000000000000000000007b0000000000000000000000000000000000000000000000000000000000000057000000000000000000000000000000000000000000000000000000000000007f000000000000000000000000000000000000000000000000000000000000002f000000000000000000000000000000000000000000000000000000000000004700000000000000000000000000000000000000000000000000000000000000e5000000000000000000000000000000000000000000000000000000000000005b0000000000000000000000000000000000000000000000000000000000000094000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000000000000000000000000000000000000000000da000000000000000000000000000000000000000000000000000000000000003e000000000000000000000000000000000000000000000000000000000000002900000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000059000000000000000000000000000000000000000000000000000000000000003f000000000000000000000000000000000000000000000000000000000000005400000000000000000000000000000000000000000000000000000000000000c200000000000000000000000000000000000000000000000000000000000000f600000000000000000000000000000000000000000000000000000000000000cc000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000d1000000000000000000000000000000000000000000000000000000000000009f000000000000000000000000000000000000000000000000000000000000004a00000000000000000000000000000000000000000000000000000000000000be00000000000000000000000000000000000000000000000000000000000000d60000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000005f0000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000004f0000000000000000000000000000000000000000000000000000000000000056000000000000000000000000000000000000000000000000000000000000003f000000000000000000000000000000000000000000000000000000000000006b000000000000000000000000000000000000000000000000000000000000008d000000000000000000000000000000000000000000000000000000000000000f000000000000000000000000000000000000000000000000000000000000004900000000000000000000000000000000000000000000000000000000000000df0000000000000000000000000000000000000000000000000000000000000027000000000000000000000000000000000000000000000000000000000000003d00000000000000000000000000000000000000000000000000000000000000be00000000000000000000000000000000000000000000000000000000000000810000000000000000000000000000000000000000000000000000000000000053000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000290000000000000000000000000000000000000000000000000000000000000089000000000000000000000000000000000000000000000000000000000000001600000000000000000000000000000000000000000000000000000000000000cb000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000e1000000000000000000000000000000000000000000000000000000000000008a000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000000e";

        evenNumber.validate( post_state_digest, seal);
        //assertEq(evenNumber.get(), number);
    }

//    function test_SetZero() public {
//        uint256 number = 0;
//        (bytes memory journal, bytes32 post_state_digest, bytes memory seal) =
//            prove(Elf.IS_EVEN_PATH, abi.encode(number));
//
//        evenNumber.set(abi.decode(journal, (uint256)), post_state_digest, seal);
//        assertEq(evenNumber.get(), number);
//    }
}
